{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import { transform } from \"@babel/core\"\nimport dlight, { type DLightOption } from \"babel-preset-dlight\"\nimport { minimatch } from \"minimatch\"\nimport { Plugin, TransformResult } from \"vite\"\n\nexport default function (options: DLightOption = {}): Plugin {\n  const {\n    files: preFiles = \"**/*.{js,jsx,ts,tsx}\",\n    excludeFiles: preExcludeFiles = \"**/{dist,node_modules,lib}/*.{js,ts}\",\n  } = options\n  const files = Array.isArray(preFiles) ? preFiles : [preFiles]\n  const excludeFiles = Array.isArray(preExcludeFiles)\n    ? preExcludeFiles\n    : [preExcludeFiles]\n\n  return {\n    name: \"dlight\",\n    enforce: \"pre\",\n    transform(code: string, id: string) {\n      let enter = false\n      for (const allowedPath of files) {\n        if (minimatch(id, allowedPath)) {\n          enter = true\n          break\n        }\n      }\n      for (const notAllowedPath of excludeFiles) {\n        if (minimatch(id, notAllowedPath)) {\n          enter = false\n          break\n        }\n      }\n      if (!enter) return\n      return transform(code, {\n        babelrc: false,\n        configFile: false,\n        presets: [[dlight, options]],\n        sourceMaps: true,\n        filename: id,\n      }) as TransformResult\n    },\n  }\n}\n"],"mappings":"AAAA,OAAS,aAAAA,MAAiB,cAC1B,OAAOC,MAAmC,sBAC1C,OAAS,aAAAC,MAAiB,YAGX,SAARC,EAAkBC,EAAwB,CAAC,EAAW,CAC3D,GAAM,CACJ,MAAOC,EAAW,uBAClB,aAAcC,EAAkB,sCAClC,EAAIF,EACEG,EAAQ,MAAM,QAAQF,CAAQ,EAAIA,EAAW,CAACA,CAAQ,EACtDG,EAAe,MAAM,QAAQF,CAAe,EAC9CA,EACA,CAACA,CAAe,EAEpB,MAAO,CACL,KAAM,SACN,QAAS,MACT,UAAUG,EAAcC,EAAY,CAClC,IAAIC,EAAQ,GACZ,QAAWC,KAAeL,EACxB,GAAIL,EAAUQ,EAAIE,CAAW,EAAG,CAC9BD,EAAQ,GACR,MAGJ,QAAWE,KAAkBL,EAC3B,GAAIN,EAAUQ,EAAIG,CAAc,EAAG,CACjCF,EAAQ,GACR,MAGJ,GAAKA,EACL,OAAOX,EAAUS,EAAM,CACrB,QAAS,GACT,WAAY,GACZ,QAAS,CAAC,CAACR,EAAQG,CAAO,CAAC,EAC3B,WAAY,GACZ,SAAUM,CACZ,CAAC,CACH,CACF,CACF","names":["transform","dlight","minimatch","src_default","options","preFiles","preExcludeFiles","files","excludeFiles","code","id","enter","allowedPath","notAllowedPath"]}